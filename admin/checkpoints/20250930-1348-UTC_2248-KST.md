---
file: admin/checkpoints/20250930-1348-UTC_2248-KST.md
title: Preview focus/highlight 연동 및 guardrail 시각화 강화
owner: duksan
created: 2025-09-30 13:48 UTC / 2025-09-30 22:48 KST
updated: 2025-09-30 13:52 UTC / 2025-09-30 22:52 KST
status: completed
tags: [checkpoint, figma, plugin, preact]
schemaVersion: 1
description: PreviewControls에서 프레임 포커스/섹션 하이라이트를 postMessage로 연결하고 guardrail 메트릭 뱃지·히스토리를 추가했다.
---

## Summary

- `createPreviewService`를 구현해 PreviewControls에서 프레임 포커스와 섹션 하이라이트를 Figma 런타임에 요청하도록 했고, UI에 전용 버튼/인터랙션을 배치했다.
- GuardrailSummary와 ResultLog에 메트릭 배지·히스토리 뷰를 추가하고 guardrail 스토어에 히스토리를 적재해 추세를 시각화했다.
- Figma `main.ts`에서 `preview-focus-frame`, `preview-highlight-section` 메시지를 처리해 실제 프레임 선택 및 슬롯 기반 하이라이트를 수행하도록 확장했다.

## Impacted files

- admin/plan/figmaplugin-refactor.md
- figma-hello-plugin/src/main.ts
- figma-hello-plugin/src/ui/app.tsx
- figma-hello-plugin/src/ui/components/ExecutionPanel.tsx
- figma-hello-plugin/src/ui/components/ExecutionPanel/GuardrailSummary.tsx
- figma-hello-plugin/src/ui/components/PreviewControls/index.tsx
- figma-hello-plugin/src/ui/components/PreviewControls/SlotHighlight.tsx
- figma-hello-plugin/src/ui/components/PreviewControls/BeforeAfter.tsx
- figma-hello-plugin/src/ui/components/ResultLog.tsx
- figma-hello-plugin/src/ui/services/io-listener.ts
- figma-hello-plugin/src/ui/services/preview.ts
- figma-hello-plugin/src/ui/services/index.ts
- figma-hello-plugin/src/ui/services/facade/index.ts
- figma-hello-plugin/src/ui/store/guardrailStore.ts
- figma-hello-plugin/src/ui/store/index.ts
- figma-hello-plugin/src/ui/styles/app.css

## Follow-ups

- [ ] 섹션 하이라이트 시 guardrail 이슈 종류에 따라 다른 스타일(예: 깜박임) 적용 검토.
- [ ] guardrail history를 기반으로 그래프/스파크라인을 추가해 추세를 더 직관적으로 제공.
- [ ] 하이라이트 시 섹션 병합 실행과 schemaStore 동기화를 구성해 수동 선택 단계를 줄인다.
